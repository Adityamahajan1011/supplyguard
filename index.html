<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SupplyGuard â€” Supply Chain Monitor</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=Instrument+Sans:wght@400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="css/styles.css">
</head>
<body>

<!-- â•â• SIDEBAR â•â• -->
<aside class="sidebar">
  <div class="logo-wrap">
    <div class="logo-mark">ğŸ›¡ï¸</div>
    <div class="logo-name">Supply<span>Guard</span></div>
    <div class="logo-sub">Violation Detection v2</div>
  </div>
  <nav class="nav">
    <div class="nav-section-label">Modules</div>
    <button class="nav-item active" data-page="overview" onclick="showPage('overview',this)">
      <div class="nav-icon">âŠ</div><span>Overview</span>
    </button>
    <button class="nav-item" data-page="poles" onclick="showPage('poles',this)">
      <div class="nav-icon">âš¡</div><span>Pole Monitor</span>
      <span class="nav-badge ok" id="navPoleBadge">OK</span>
    </button>
    <button class="nav-item" data-page="temperature" onclick="showPage('temperature',this)">
      <div class="nav-icon">ğŸŒ¡</div><span>Temperature</span>
      <span class="nav-badge ok" id="navTempBadge">OK</span>
    </button>
    <button class="nav-item" data-page="workers" onclick="showPage('workers',this)">
      <div class="nav-icon">ğŸ‘</div><span>Face Recognition</span>
      <span class="nav-badge ok" id="navFaceBadge">OK</span>
    </button>
  </nav>
  <div class="sidebar-footer">
    <div class="sys-pill">
      <div class="sys-dot green" id="sysDot"></div>
      <span id="sysText">All systems live</span>
    </div>
  </div>
</aside>

<!-- â•â• MAIN â•â• -->
<div class="main">

  <!-- TOPBAR -->
  <div class="topbar">
    <div class="page-title" id="pageTitle">
      Overview <span class="page-sub">Supply Chain Monitor</span>
    </div>
    <div class="topbar-chips">
      <div class="chip chip-time" id="clockEl">--:--:--</div>
      <div class="chip chip-live">LIVE</div>
    </div>
  </div>

  <!-- â•â•â• PAGE: OVERVIEW â•â•â• -->
  <div class="page active" id="page-overview">
    <div class="stats-grid">
      <div class="stat-card stat-card-1">
        <div class="stat-icon-wrap">âš¡</div>
        <div class="stat-lbl">Poles Online</div>
        <div class="stat-val" id="ov-poles">9</div>
        <div class="stat-sub ok" id="ov-poles-sub">All operational</div>
      </div>
      <div class="stat-card stat-card-2">
        <div class="stat-icon-wrap">ğŸŒ¡</div>
        <div class="stat-lbl">Temperature</div>
        <div class="stat-val" id="ov-temp">28Â°C</div>
        <div class="stat-sub ok" id="ov-temp-sub">Within safe range</div>
      </div>
      <div class="stat-card stat-card-3">
        <div class="stat-icon-wrap">ğŸ‘·</div>
        <div class="stat-lbl">Workers On-Site</div>
        <div class="stat-val">4</div>
        <div class="stat-sub ok" id="ov-work-sub">No overtime</div>
      </div>
      <div class="stat-card stat-card-4">
        <div class="stat-icon-wrap">ğŸš¨</div>
        <div class="stat-lbl">Violations Today</div>
        <div class="stat-val" id="ov-viol">0</div>
        <div class="stat-sub ok" id="ov-viol-sub">Clean record</div>
      </div>
    </div>

    <div class="module-cards-grid">
      <div class="module-card module-card-1" onclick="showPage('poles',document.querySelectorAll('.nav-item')[1])">
        <div class="mc-icon-ring">âš¡</div>
        <div class="mc-title">Pole Wire Monitor</div>
        <div class="mc-desc">ESP32 sensor tracks wire integrity across 9 distribution poles via GPIO voltage readings.</div>
        <div class="mc-footer">
          <span id="ov-pole-status">
            <span class="mc-status-dot" style="background:var(--teal)"></span>9 poles online
          </span>
          <span style="color:var(--teal);font-size:13px">â†’</span>
        </div>
      </div>
      <div class="module-card module-card-2" onclick="showPage('temperature',document.querySelectorAll('.nav-item')[2])">
        <div class="mc-icon-ring">ğŸŒ¡</div>
        <div class="mc-title">Temperature Monitor</div>
        <div class="mc-desc">DHT22 sensors track warehouse temp across 3 zones â€” alerts fire above 45Â°C threshold.</div>
        <div class="mc-footer">
          <span id="ov-temp-status">
            <span class="mc-status-dot" style="background:var(--green)"></span>28Â°C â€” Safe
          </span>
          <span style="color:var(--orange);font-size:13px">â†’</span>
        </div>
      </div>
      <div class="module-card module-card-3" onclick="showPage('workers',document.querySelectorAll('.nav-item')[3])">
        <div class="mc-icon-ring">ğŸ‘</div>
        <div class="mc-title">Face Recognition</div>
        <div class="mc-desc">CNN model identifies workers and tracks total time on-site from first detection.</div>
        <div class="mc-footer">
          <span id="ov-face-status">
            <span class="mc-status-dot" style="background:var(--green)"></span>4 tracked, no overtime
          </span>
          <span style="color:var(--green);font-size:13px">â†’</span>
        </div>
      </div>
    </div>

    <div style="display:grid;grid-template-columns:1fr 1fr;gap:18px;">
      <div class="card">
        <div class="card-header">
          <div class="card-title">ğŸ“‹ Recent Activity</div>
          <span class="badge badge-info" id="actBadge">0 events</span>
        </div>
        <div class="card-body" style="padding:0 18px;">
          <div id="actFeed"></div>
        </div>
      </div>
      <div class="card">
        <div class="card-header">
          <div class="card-title">ğŸ”” Notifications</div>
          <span class="badge badge-ok" id="notifBadge">0 alerts</span>
        </div>
        <div class="card-body" style="padding:10px 18px;">
          <div class="notif-list" id="notifList">
            <div class="notif-item ok">
              <div class="notif-title">âœ… System Online</div>
              <div class="notif-body">All monitoring modules initialized</div>
              <div class="notif-time">Just now</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â•â• PAGE: POLES â•â•â• -->
  <div class="page" id="page-poles">
    <div class="alert-bar danger" id="poleAlertBar">
      <span class="alert-icon">âš¡</span>
      <div class="alert-body">
        <div class="alert-title" id="poleAlertTitle">Wire Breakdown Detected</div>
        <div class="alert-desc" id="poleAlertDesc">ESP32 reports wire failure</div>
      </div>
      <span class="alert-x" onclick="this.parentElement.classList.remove('show')">âœ•</span>
    </div>

    <div class="pole-layout">
      <!-- Map -->
      <div class="map-wrap">
        <div class="map-header">
          <div class="map-title">ğŸ—º Distribution Network Map</div>
          <span class="badge badge-teal" id="mapBadge">All Online</span>
        </div>
        <div class="map-svg-area">
          <svg class="map-svg" viewBox="0 0 600 300" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <pattern id="pg" width="30" height="30" patternUnits="userSpaceOnUse">
                <path d="M30 0L0 0 0 30" fill="none" stroke="rgba(255,255,255,0.025)" stroke-width="0.5"/>
              </pattern>
            </defs>
            <rect width="600" height="300" fill="url(#pg)"/>
            <path class="road" d="M50 150 H560"/>
            <path class="road-line" d="M50 150 H560"/>
            <path class="road" d="M180 20 V280"/>
            <path class="road-line" d="M180 20 V280"/>
            <path class="road" d="M390 20 V280"/>
            <path class="road-line" d="M390 20 V280"/>
            <text class="road-label" x="540" y="145">Main Rd</text>
            <text class="road-label" x="183" y="15">Line A</text>
            <text class="road-label" x="393" y="15">Line B</text>
            <g id="wireG"></g>
            <g id="poleG"></g>
          </svg>
        </div>
        <div class="map-legend">
          <div class="leg"><div class="leg-dot" style="background:var(--teal)"></div>Operational</div>
          <div class="leg"><div class="leg-dot" style="background:var(--red)"></div>Wire Break</div>
          <div class="leg"><div class="leg-dot" style="background:var(--blue)"></div>ESP32 Sensor</div>
          <div style="margin-left:auto;font-size:11px;color:var(--text3)">Click pole to toggle</div>
        </div>
      </div>

      <!-- Side panel -->
      <div style="display:flex;flex-direction:column;gap:14px;">
        <div class="card">
          <div class="card-header"><div class="card-title">ğŸ“¡ ESP32 Terminal</div><span class="badge badge-teal">USB</span></div>
          <div class="card-body" style="padding:10px;">
            <div class="esp32-terminal" id="esp32T"></div>
          </div>
        </div>
        <div class="card">
          <div class="card-header"><div class="card-title">âš¡ Pole Status</div></div>
          <div class="card-body" style="padding:12px;" id="poleListEl"></div>
        </div>
        <div style="display:flex;gap:8px;">
          <button class="btn btn-danger btn-sm" onclick="simBreak()">âš¡ Simulate Break</button>
          <button class="btn btn-ghost btn-sm" onclick="resetPoles()">â†º Reset</button>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â•â• PAGE: TEMPERATURE â•â•â• -->
  <div class="page" id="page-temperature">
    <div class="alert-bar danger" id="tempAlertBar">
      <span class="alert-icon">ğŸŒ¡</span>
      <div class="alert-body">
        <div class="alert-title" id="tempAlertTitle">Temperature Danger</div>
        <div class="alert-desc" id="tempAlertDesc">Temperature exceeds safe threshold</div>
      </div>
      <span class="alert-x" onclick="this.parentElement.classList.remove('show')">âœ•</span>
    </div>

    <div class="temp-layout">
      <div class="temp-hero-card">
        <div class="card-header">
          <div class="card-title">ğŸŒ¡ Live Reading â€” Zone A</div>
          <span class="badge badge-ok" id="tempBadge">SAFE</span>
        </div>
        <div class="card-body" style="padding:20px 0 0;">
          <div class="temp-big safe" id="tempBig">28<span class="temp-unit">Â°C</span></div>
          <div class="temp-zone">WAREHOUSE Â· SENSOR DHT22</div>
          <div class="temp-pill safe" id="tempPill">
            <div class="sys-dot green"></div> Safe â€” Within limits
          </div>
          <div class="gauge-wrap">
            <svg class="gauge-svg" viewBox="0 0 180 100">
              <path d="M15 88 A73 73 0 0 1 165 88" fill="none" stroke="rgba(255,255,255,0.07)" stroke-width="10" stroke-linecap="round"/>
              <path d="M15 88 A73 73 0 0 1 80 18"  fill="none" stroke="rgba(38,208,178,0.4)"   stroke-width="10" stroke-linecap="round"/>
              <path d="M80 18 A73 73 0 0 1 135 28"  fill="none" stroke="rgba(255,149,72,0.4)"   stroke-width="10" stroke-linecap="round"/>
              <path d="M135 28 A73 73 0 0 1 165 88" fill="none" stroke="rgba(255,77,109,0.4)"   stroke-width="10" stroke-linecap="round"/>
              <line id="gneedle" x1="90" y1="88" x2="90" y2="24"
                stroke="var(--blue)" stroke-width="2.5" stroke-linecap="round"
                transform="rotate(-90,90,88)" style="transition:transform 0.8s ease"/>
              <circle cx="90" cy="88" r="5" fill="var(--blue)"/>
              <text x="8"   y="100" font-size="8" fill="var(--text3)" font-family="Instrument Sans">0Â°</text>
              <text x="86"  y="12"  font-size="8" fill="var(--text3)" font-family="Instrument Sans" text-anchor="middle">50Â°</text>
              <text x="170" y="100" font-size="8" fill="var(--text3)" font-family="Instrument Sans" text-anchor="end">100Â°</text>
            </svg>
          </div>
        </div>
      </div>

      <div style="display:flex;flex-direction:column;gap:14px;">
        <div class="card">
          <div class="card-header"><div class="card-title">ğŸ“Š Statistics</div></div>
          <div class="card-body">
            <div class="readings-grid">
              <div class="reading-box"><div class="reading-val" id="rCurrent" style="color:var(--teal)">28Â°C</div><div class="reading-lbl">Current</div></div>
              <div class="reading-box"><div class="reading-val" id="rMax"     style="color:var(--red)">35Â°C</div><div class="reading-lbl">Max Today</div></div>
              <div class="reading-box"><div class="reading-val" id="rMin"     style="color:var(--blue)">22Â°C</div><div class="reading-lbl">Min Today</div></div>
              <div class="reading-box"><div class="reading-val"               style="color:var(--orange)">45Â°C</div><div class="reading-lbl">Threshold</div></div>
            </div>
          </div>
        </div>
        <div class="card">
          <div class="card-header"><div class="card-title">ğŸ“ˆ History</div></div>
          <div class="card-body" style="padding:12px;">
            <canvas id="tempChart" height="70" style="width:100%"></canvas>
          </div>
        </div>
        <div style="display:flex;gap:8px;">
          <button class="btn btn-warn btn-sm" onclick="simTempSpike()">ğŸ”¥ Temp Spike</button>
          <button class="btn btn-ghost btn-sm" onclick="resetTemp()">â†º Normalize</button>
        </div>
      </div>
    </div>

    <div class="card" style="margin-top:18px;">
      <div class="card-header"><div class="card-title">ğŸ­ Zone Overview</div></div>
      <div class="card-body"><div class="zones-grid" id="zonesGrid"></div></div>
    </div>
  </div>

  <!-- â•â•â• PAGE: WORKERS / FACE RECOGNITION â•â•â• -->
  <div class="page" id="page-workers">
    <div class="alert-bar warn" id="faceAlertBar">
      <span class="alert-icon">â±</span>
      <div class="alert-body">
        <div class="alert-title" id="faceAlertTitle">Overtime Alert</div>
        <div class="alert-desc" id="faceAlertDesc">Worker has exceeded shift limit</div>
      </div>
      <span class="alert-x" onclick="this.parentElement.classList.remove('show')">âœ•</span>
    </div>

    <div class="face-layout">
      <!-- Camera panel -->
      <div style="display:flex;flex-direction:column;gap:14px;">
        <div class="cam-card">
          <div class="card-header">
            <div class="card-title">ğŸ“· Live Camera</div>
            <span class="badge badge-info">CNN Active</span>
          </div>
          <div class="cam-preview">
            <div class="cam-lines"></div>
            <div class="cam-scan"></div>
            <div class="cam-face-zone">
              <div class="cam-face-box">
                <div class="cam-fb-bot"></div>
                <div class="cam-face-icon">ğŸ‘¤</div>
              </div>
            </div>
            <div class="cam-bottom">
              <div class="cam-bottom-text">ResNet-50 CNN Â· 30FPS Â· DETECTING</div>
            </div>
            <div class="cam-match" id="camMatch">MATCHED</div>
            <div class="cam-conf"  id="camConf">conf: â€”</div>
          </div>
          <div class="card-body" style="padding:14px;">
            <div class="cnn-grid">
              <div class="cnn-stat"><div class="cnn-val">30</div><div class="cnn-lbl">FPS</div></div>
              <div class="cnn-stat"><div class="cnn-val" id="cnnDetected">0</div><div class="cnn-lbl">Seen Today</div></div>
              <div class="cnn-stat"><div class="cnn-val" id="cnnConf">â€”</div><div class="cnn-lbl">Last Conf.</div></div>
              <div class="cnn-stat"><div class="cnn-val" id="cnnOT">0</div><div class="cnn-lbl">Overtime</div></div>
            </div>
          </div>
        </div>
        <button class="btn btn-warn" onclick="simOvertime()" style="width:100%">â± Simulate Overtime</button>
      </div>

      <!-- Worker table -->
      <div class="card">
        <div class="card-header">
          <div class="card-title">ğŸ‘· Worker Time Tracker</div>
          <span class="badge badge-ok" id="workerBadge">No Overtime</span>
        </div>
        <div class="card-body" style="padding:0;">
          <table class="worker-tbl">
            <thead>
              <tr>
                <th>Worker</th>
                <th>Time On-Site</th>
                <th>Progress (9h limit)</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody id="workerTbody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Log + Notif -->
    <div class="log-grid">
      <div class="card">
        <div class="card-header"><div class="card-title">ğŸ“‹ Event Log</div></div>
        <div class="card-body" style="padding:10px;">
          <div class="log-terminal" id="logEl"></div>
        </div>
      </div>
      <div class="card">
        <div class="card-header"><div class="card-title">ğŸ”” Alerts</div></div>
        <div class="card-body" style="padding:10px;">
          <div class="notif-list" id="notifList2"></div>
        </div>
      </div>
    </div>
  </div>

</div><!-- /main -->

<!-- â•â• DEMO BAR â•â• -->
<div class="demo-bar">
  <span class="demo-lbl">Demo:</span>
  <div class="btn-group">
    <button class="btn btn-danger btn-sm" onclick="simBreak()">âš¡ Wire Break</button>
    <button class="btn btn-warn   btn-sm" onclick="simTempSpike()">ğŸŒ¡ Temp Spike</button>
    <button class="btn btn-warn   btn-sm" onclick="simOvertime()">â± Overtime</button>
    <button class="btn btn-danger btn-sm" onclick="simAll()">ğŸš¨ All Alerts</button>
    <button class="btn btn-ghost  btn-sm" onclick="resetAll()">â†º Reset All</button>
  </div>
</div>

<!-- Scripts â€” ORDER MATTERS -->
<script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
<script src="js/app.js"></script>
<script src="js/poles.js"></script>
<script src="js/temperature.js"></script>
<script src="js/workers.js"></script>

</body>
</html>